<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Calcolatore Subnet G.C.</title>
    <link rel="stylesheet" href="stile.css">
    <script>
        function ip(){
            var stringa = "" + document.getElementById("ip").value;
            var cidr = document.getElementById("cidr").value;
            var numeri = stringa.split(".");

            // Controllo che il numero di "." sia uguale a 4 (numero di parti dell'indirizzo).
            if (numeri.length !== 4){
                document.getElementById("ip").value = "Non valido!";
                return;
            }

            // Verifica che ogni numero letto sia tra 0 e 255.
            for (var n = 0; n < numeri.length; n++){
                if (numeri[n] > 255 || numeri[n] < 0 || isNaN(numeri[n])){
                    document.getElementById("ip").value = "Non valido!";
                    return;
                }
            }

            // Se in input viene dato un CIDR verifica che questo sia minore di 32.
            if (cidr < 0 || cidr > 32){
                document.getElementById("cidr").value = 0;
                return;
            }

            // Parte IP Binario.
            calcoloIP(numeri);

            // Parte Subnet Mask.
            calcoloSM(cidr);
        }

        function calcoloIP(numeri){

            // Resetta i valori precedenti.
            document.getElementById("ipBin").value = "";

            // Converte decimale in binario.
            for (var i = 0; i < numeri.length; i++){
                var binario = (+numeri[i]).toString(2);

                // Aggiunge degli 0 per "riempire" gli spazi vuoti per valori binario piÃ¹ piccoli.
                if (binario.length < 8){
                    var n = binario.length;
                    while (n < 8){
                        binario = "0" + binario;
                        n++;
                    }
                }

                // Setta il valore finale.
                document.getElementById("ipBin").value += binario;

                // Aggiunge dei "." per dividere dove necessario.
                if (i < numeri.length - 1){
                    document.getElementById("ipBin").value += ".";
                }
            }

        }

        function calcoloSM(cidr){

            // Resetta i valori della Subnet Mask binaria e decimale.
            document.getElementById("smBin").value = "";
            document.getElementById("sm").value = "";

            var n;
            var nVet = "";

            // Aggiunge i valori 1.
            for (n = 1; n <= cidr; n++){
                document.getElementById("smBin").value += "1";
                nVet += "1";

                // Aggiunge dei "." dove necessario.
                if (n !== 0 && n !== 32 && n % 8 === 0){
                    document.getElementById("smBin").value += ".";
                    nVet += ".";
                }
            }

            // Aggiunge i valori 0.
            for (; n <= 32; n++) {
                document.getElementById("smBin").value += "0";
                nVet += "0";

                // Aggiunge un "." dove necessario.
                if (n !== 0 && n !== 32 && n % 8 === 0){
                    document.getElementById("smBin").value += ".";
                    nVet += ".";
                }
            }

            // Calcola in decimale il binario della Subnet Mask.
            var coppie = nVet.split(".");
            for (var i = 0; i < coppie.length; i++){
                document.getElementById("sm").value += parseInt(coppie[i], 2);

                // Aggiunge dei "." dove necessario.
                if (i !== coppie.length - 1){
                    document.getElementById("sm").value += ".";
                }
            }
        }
    </script>
</head>
<body>
<h1>Calcolatore Subnet di G.C.</h1>
<h4>Inserire i dati dove richiesto (indirizzo ip e CIDR).</h4>
<br>
<div class="contenitore">
<h3>Indirizzo IP:</h3>
<input id="ip" type="text" min="0" max="255" value="192.168.0.1" style="width:140px; height: 50px"/>
</div>
<br>
<div class="contenitore">
<h3>CIDR:</h3>
<input id="cidr" type="number" min="0" max="32" style="width:50px; height: 50px"/>
</div>
<br>
<br>
<input class="pulsante" type="button" onclick="ip()" value="Calcola.">
<br>
<br>
<br>
<div class="contenitore">
    <h3>IP Binario: </h3>
    <input readonly id="ipBin" type="text">
</div>
<br>
<br>
<div class="contenitore">
<h3>SM Binario: </h3>
<input readonly id="smBin" type="text">
</div>
<br>
<div class="contenitore">
<h3>SM Decimale: </h3>
<input readonly id="sm" type="text">
</div>
</body>
</html>